<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ Ghana Financial Literacy Simulator</title>
    <meta name="theme-color" content="#2c3e50">
    <meta name="description" content="Educational financial literacy simulator for Ghanaian students and teachers">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- iOS Support -->
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ============================================
           CORE RESET & VARIABLES
        ============================================ */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #2c3e50;
            --text-light: #7f8c8d;
            --border-radius: 12px;
            --box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        /* ============================================
           SIMULATOR WARNING BANNER (ALWAYS VISIBLE)
        ============================================ */
        #simulator-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #f39c12, #d35400);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            z-index: 10000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            animation: pulse 2s infinite;
        }
        
        #simulator-warning .main-warning {
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        #simulator-warning .sub-warning {
            font-size: 12px;
            opacity: 0.9;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.9; }
        }
        
        /* ============================================
           MAIN CONTAINER
        ============================================ */
        .container {
            max-width: 1200px;
            margin: 60px auto 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            display: none;
        }
        
        /* ============================================
           HEADER & NAVIGATION
        ============================================ */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 30px;
            position: relative;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            font-size: 40px;
            background: rgba(255,255,255,0.2);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-text h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .logo-text .subtitle {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        /* ============================================
           MODALS & OVERLAYS
        ============================================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--box-shadow);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-color);
        }
        
        .modal-header h2 {
            color: var(--primary-color);
            margin: 0;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--danger-color);
            transform: scale(1.1);
        }
        
        /* ============================================
           BUTTONS
        ============================================ */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #2ecc71);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #d35400);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #c0392b);
            color: white;
        }
        
        .btn-block {
            width: 100%;
        }
        
        /* ============================================
           FORMS & INPUTS
        ============================================ */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        /* ============================================
           MAIN CONTENT LAYOUT
        ============================================ */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
        }
        
        .section {
            background: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e9ecef;
        }
        
        .section-title {
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ============================================
           CARDS & BOXES
        ============================================ */
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: var(--transition);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .summary-box {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            color: white;
        }
        
        .income-box { background: linear-gradient(135deg, var(--success-color), #2ecc71); }
        .expense-box { background: linear-gradient(135deg, var(--danger-color), #c0392b); }
        .balance-box { background: linear-gradient(135deg, var(--secondary-color), #2980b9); }
        
        /* ============================================
           EDUCATIONAL ELEMENTS
        ============================================ */
        .lesson-card {
            background: linear-gradient(135deg, #fff8e1, #fff3cd);
            border-left: 5px solid var(--warning-color);
        }
        
        .quiz-card {
            background: linear-gradient(135deg, #e8f4fc, #d6eaf8);
            border-left: 5px solid var(--secondary-color);
        }
        
        .tip-box {
            background: #e8f8f5;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--success-color);
            margin: 15px 0;
        }
        
        .tip-box strong {
            color: var(--success-color);
        }
        
        /* ============================================
           TRANSACTION HISTORY
        ============================================ */
        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .transaction-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .transaction-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        /* ============================================
           FUNDS DISPLAY
        ============================================ */
        .funds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .fund-box {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            color: white;
        }
        
        .ownership-fund { background: linear-gradient(135deg, #f39c12, #d35400); }
        .emergency-fund { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .growth-fund { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .operations-fund { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        
        /* ============================================
           GAMIFICATION (LEARNING REWARDS)
        ============================================ */
        .xp-bar-container {
            margin: 15px 0;
        }
        
        .xp-bar {
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 5px;
        }
        
        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, #f1c40f, #f39c12);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        /* ============================================
           PROGRESS INDICATORS
        ============================================ */
        .progress-bar {
            height: 10px;
            background: #ecf0f1;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), var(--success-color));
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        /* ============================================
           BADGES & ACHIEVEMENTS
        ============================================ */
        .badges-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .badge {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            position: relative;
        }
        
        .badge.locked {
            background: #bdc3c7;
            color: #95a5a6;
        }
        
        /* ============================================
           UTILITY CLASSES
        ============================================ */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
        .mt-10 { margin-top: 10px; }
        .mt-20 { margin-top: 20px; }
        .d-flex { display: flex; }
        .align-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-10 { gap: 10px; }
        .w-100 { width: 100%; }
        
        /* ============================================
           LOADING STATES
        ============================================ */
        .loading {
            opacity: 0.7;
            pointer-events: none;
            position: relative;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        /* ============================================
           PWA INSTALL PROMPT
        ============================================ */
        .pwa-prompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 10001;
            display: none;
            max-width: 400px;
            width: 90%;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from {
                transform: translate(-50%, 100%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, 0);
                opacity: 1;
            }
        }
        
        /* ============================================
           CLASSROOM FEATURES
        ============================================ */
        .classroom-code {
            font-family: monospace;
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            letter-spacing: 3px;
        }
        
        .qr-code {
            display: block;
            margin: 20px auto;
            max-width: 200px;
        }
        
        /* ============================================
           RESPONSIVE DESIGN
        ============================================ */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin-top: 80px;
            }
            
            .section {
                padding: 15px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- SIMULATOR WARNING BANNER (ALWAYS VISIBLE) -->
    <div id="simulator-warning" style="display: block;">
        <div class="main-warning">‚ö†Ô∏è FINANCIAL LITERACY SIMULATOR - EDUCATIONAL USE ONLY ‚ö†Ô∏è</div>
        <div class="sub-warning">No real money ‚Ä¢ Practice tool only ‚Ä¢ Not financial advice ‚Ä¢ Ghanaian Context</div>
    </div>

    <!-- PWA INSTALL PROMPT -->
    <div id="pwaPrompt" class="pwa-prompt">
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
            <div style="font-size: 40px;">üì±</div>
            <div>
                <h3 style="margin: 0; color: var(--primary-color);">Install Financial Literacy Simulator</h3>
                <p style="margin: 5px 0 0 0; color: var(--text-light); font-size: 14px;">Add to home screen for offline access</p>
            </div>
        </div>
        <div style="display: flex; gap: 10px;">
            <button id="installPWA" class="btn btn-success" style="flex: 1;">‚úÖ Install</button>
            <button id="dismissPWA" class="btn" style="flex: 1; background: #95a5a6; color: white;">Later</button>
        </div>
    </div>

    <!-- LEGAL DISCLAIMER MODAL (FIRST LOAD) -->
    <div id="legalDisclaimerModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 48px; color: var(--danger-color);">‚ö†Ô∏è</div>
                <h2 style="color: var(--primary-color); margin: 10px 0;">LEGAL DISCLAIMER</h2>
            </div>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="color: var(--primary-color); margin-top: 0;">FOR EDUCATIONAL USE ONLY</h3>
                <p style="color: var(--text-color); line-height: 1.6;">
                    This <strong>Financial Literacy Simulator</strong> is designed <strong>exclusively for educational purposes</strong> within Ghanaian classrooms and learning environments.
                </p>
                
                <div style="margin: 20px 0; padding: 15px; background: #fff8e1; border-radius: 5px;">
                    <p style="color: #d35400; margin: 0; font-weight: bold;">
                        üö´ DO NOT USE FOR REAL FINANCIAL MANAGEMENT
                    </p>
                </div>
                
                <h4 style="color: var(--primary-color);">Key Points:</h4>
                <ul style="color: var(--text-color); padding-left: 20px; margin-bottom: 15px;">
                    <li>All financial data is <strong>simulated</strong> and <strong>fictional</strong></li>
                    <li>No real money transactions are possible</li>
                    <li>Not a substitute for professional financial advice</li>
                    <li>Designed for classroom instruction and self-learning</li>
                    <li>All examples use Ghanaian Cedi (GH‚Çµ) for contextual learning</li>
                </ul>
                
                <div style="margin: 20px 0; padding: 15px; background: #e8f4fc; border-radius: 5px;">
                    <p style="color: var(--secondary-color); margin: 0;">
                        <strong>üá¨üá≠ Ghanaian Educational Context:</strong><br>
                        Examples use local pricing, common expenses, and culturally relevant scenarios to enhance learning relevance.
                    </p>
                </div>
            </div>
            
            <div style="text-align: center;">
                <button id="acceptDisclaimer" class="btn btn-success" style="padding: 15px 40px; font-size: 16px;">
                    ‚úÖ I Understand &amp; Accept - Start Learning
                </button>
            </div>
            
            <p style="color: var(--text-light); font-size: 12px; text-align: center; margin-top: 20px;">
                ¬© 2024 Financial Literacy Simulator ‚Ä¢ Ghana Education Edition
            </p>
        </div>
    </div>

    <!-- WELCOME MODAL (AFTER DISCLAIMER) -->
    <div id="welcomeModal" class="modal-overlay" style="display: flex;">
        <div class="modal-content">
            <div style="text-align: center;">
                <div style="font-size: 60px; margin-bottom: 20px;">üè´</div>
                <h1 style="color: var(--primary-color); margin-bottom: 10px;">Financial Literacy Simulator</h1>
                <p style="color: var(--text-light); margin-bottom: 30px;">Ghanaian Educational Edition</p>
            </div>
            
            <div style="margin-bottom: 30px;">
                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Choose Your Learning Path:</h3>
                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                    <button class="btn btn-primary" onclick="startLearning('student')">
                        <i class="fas fa-user-graduate"></i> Student Learner
                    </button>
                    <button class="btn" style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white;" onclick="startLearning('teacher')">
                        <i class="fas fa-chalkboard-teacher"></i> Teacher/Educator
                    </button>
                    <button class="btn btn-warning" onclick="startLearning('entrepreneur')">
                        <i class="fas fa-briefcase"></i> Entrepreneur Scenario
                          <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
                <p style="color: #7f8c8d; font-size: 14px; margin-bottom: 10px;">For teachers:</p>
                </div></button><button onclick="copyAllCode()" style="background: #f8f9fa; color: #2c3e50; border: 2px dashed #3498db; padding: 10px 20px; border-radius: 8px; cursor: pointer; width: 100%;">
                    üì• Copy Project Code
                    </button>
                </div>
            </div>
            
            <div class="tip-box">
                <p><strong>üéØ Learning Objectives:</strong></p>
                <ul style="margin-left: 20px; color: var(--text-color);">
                    <li>Understand the 50/30/20 budgeting rule</li>
                    <li>Practice fund allocation principles</li>
                    <li>Learn expense categorization</li>
                    <li>Track simulated financial progress</li>
                    <li>Prepare for real-world financial decisions</li>
                </ul>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="startLearning('student')" style="padding: 15px 40px; font-size: 18px; font-weight: bold;">
                    <i class="fas fa-rocket"></i> Start Learning Now
                </button>
            </div>
            
            <p style="color: var(--text-light); font-size: 12px; text-align: center; margin-top: 20px;">
                Version 1.0 ‚Ä¢ Designed for Ghanaian Educational Institutions
            </p>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div class="container" id="appContainer">
        <header>
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üí∞</div>
                    <div class="logo-text">
                        <h1>Financial Literacy Simulator</h1>
                        <div class="subtitle">Ghanaian Educational Edition</div>
                    </div>
                </div>
                
                <div class="user-profile" id="userProfile">
                    <div class="user-avatar" id="userAvatar">üë®‚Äçüéì</div>
                    <div>
                        <div style="font-weight: bold;" id="userName">Student Learner</div>
                        <div style="font-size: 12px;" id="userRole">Level 1 ‚Ä¢ 50 XP</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- QUICK ACTION BUTTONS -->
        <div style="padding: 15px 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef;">
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="showLesson('budgeting')">
                    <i class="fas fa-book"></i> Lessons
                </button>
                <button class="btn" style="background: #9b59b6; color: white;" onclick="showClassroomTools()">
                    <i class="fas fa-chalkboard"></i> Classroom
                </button>
                <button class="btn btn-warning" onclick="showQuiz()">
                    <i class="fas fa-question-circle"></i> Quiz
                </button>
                <button class="btn btn-success" onclick="showProgress()">
                    <i class="fas fa-chart-line"></i> Progress
                </button>
                <button class="btn" style="background: #34495e; color: white;" onclick="resetSimulator()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- LEFT COLUMN: INCOME & LEARNING -->
            <div>
                <!-- DAILY LEARNING CHALLENGE -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-bullseye"></i> Today's Learning Challenge</h2>
                    <div class="card lesson-card">
                        <h3 style="color: var(--warning-color); margin-bottom: 10px;">Budgeting Basics</h3>
                        <p style="color: var(--text-color); margin-bottom: 15px;">
                            Learn to allocate GH‚Çµ2,000 monthly income using the 50/30/20 rule.
                        </p>
                        <div class="progress-bar">
                            <div class="progress-fill" id="challengeProgress" style="width: 30%;"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span style="font-size: 12px; color: var(--text-light);">Progress</span>
                            <span style="font-size: 12px; color: var(--warning-color); font-weight: bold;">30%</span>
                        </div>
                        <button class="btn btn-warning w-100 mt-10" onclick="startLesson('budgeting')">
                            <i class="fas fa-play-circle"></i> Start Lesson
                        </button>
                    </div>
                </div>

                <!-- FINANCIAL SUMMARY -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-chart-bar"></i> Simulated Financial Summary</h2>
                    <div class="summary-grid">
                        <div class="summary-box income-box">
                            <div style="font-size: 14px; margin-bottom: 5px;">Simulated Income</div>
                            <div style="font-size: 24px; font-weight: bold;" id="totalIncome">GH‚Çµ 2,500</div>
                        </div>
                        <div class="summary-box expense-box">
                            <div style="font-size: 14px; margin-bottom: 5px;">Practice Expenses</div>
                            <div style="font-size: 24px; font-weight: bold;" id="totalExpenses">GH‚Çµ 600</div>
                        </div>
                        <div class="summary-box balance-box">
                            <div style="font-size: 14px; margin-bottom: 5px;">Available Balance</div>
                            <div style="font-size: 24px; font-weight: bold;" id="balance">GH‚Çµ 1,900</div>
                        </div>
                    </div>
                </div>

                <!-- ADD SIMULATED INCOME -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-money-bill-wave"></i> Add Simulated Income</h2>
                    <div class="form-group">
                        <label for="incomeAmount"><i class="fas fa-ghs"></i> Amount (GH‚Çµ)</label>
                        <input type="number" id="incomeAmount" placeholder="Enter practice amount" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label for="incomeSource"><i class="fas fa-briefcase"></i> Income Source</label>
                        <select id="incomeSource">
                            <option value="Salary">üíº Salary (Teaching)</option>
                            <option value="Business">üè¢ Small Business</option>
                            <option value="Freelance">üë®‚Äçüíª Freelance Work</option>
                            <option value="Trading">üõí Trading</option>
                            <option value="Other">üíµ Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="incomeDescription"><i class="fas fa-file-alt"></i> Description (Optional)</label>
                        <input type="text" id="incomeDescription" placeholder="Describe this practice income">
                    </div>
                    <button class="btn btn-success btn-block" onclick="addSimulatedIncome()">
                        <i class="fas fa-plus-circle"></i> Add Simulated Income
                    </button>
                </div>

                <!-- LEARNING TIP -->
                <div class="section">
                    <div class="tip-box">
                        <p><strong>üí° Ghanaian Context Tip:</strong></p>
                        <p>The average monthly salary in Ghana ranges from GH‚Çµ800 to GH‚Çµ5,000 depending on profession and experience level. Always budget based on your actual income.</p>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN: EXPENSES & PROGRESS -->
            <div>
                <!-- FUND ALLOCATION -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-piggy-bank"></i> Practice Fund Allocation</h2>
                    <p style="color: var(--text-color); margin-bottom: 15px;">
                        Learn to allocate income into different savings categories:
                    </p>
                    <div class="funds-grid">
                        <div class="fund-box ownership-fund">
                            <div style="font-size: 24px;">üí∞</div>
                            <div style="font-weight: bold;">Ownership</div>
                            <div style="font-size: 18px;" id="ownershipFund">GH‚Çµ 250</div>
                            <small>10% of income</small>
                        </div>
                        <div class="fund-box emergency-fund">
                            <div style="font-size: 24px;">üö®</div>
                            <div style="font-weight: bold;">Emergency</div>
                            <div style="font-size: 18px;" id="emergencyFund">GH‚Çµ 250</div>
                            <small>10% of income</small>
                        </div>
                        <div class="fund-box growth-fund">
                            <div style="font-size: 24px;">üìà</div>
                            <div style="font-weight: bold;">Growth</div>
                            <div style="font-size: 18px;" id="growthFund">GH‚Çµ 125</div>
                            <small>5% of income</small>
                        </div>
                        <div class="fund-box operations-fund">
                            <div style="font-size: 24px;">üíº</div>
                            <div style="font-weight: bold;">Operations</div>
                            <div style="font-size: 18px;" id="operationsFund">GH‚Çµ 1,150</div>
                            <small>Spending money</small>
                        </div>
                    </div>
                </div>

                <!-- ADD PRACTICE EXPENSE -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-shopping-cart"></i> Add Practice Expense</h2>
                    <div class="form-group">
                        <label for="expenseAmount"><i class="fas fa-ghs"></i> Amount (GH‚Çµ)</label>
                        <input type="number" id="expenseAmount" placeholder="Enter practice amount" min="0" step="10">
                    </div>
                    <div class="form-group">
                        <label for="expenseCategory"><i class="fas fa-tags"></i> Category</label>
                        <select id="expenseCategory">
                            <option value="">Select category</option>
                            <optgroup label="‚úÖ Essential Expenses">
                                <option value="Housing">üè† Housing (Rent/Mortgage)</option>
                                <option value="Food">üçé Food &amp; Groceries</option>
                                <option value="Transport">üöó Transportation</option>
                                <option value="Utilities">üí° Utilities (Electricity/Water)</option>
                                <option value="Education">üéì Education</option>
                                <option value="Healthcare">üè• Healthcare</option>
                            </optgroup>
                            <optgroup label="üí° Learning Opportunities">
                                <option value="Entertainment">üé¨ Entertainment</option>
                                <option value="Shopping">üõçÔ∏è Shopping</option>
                                <option value="Eating Out">üçΩÔ∏è Eating Out</option>
                                <option value="Travel">‚úàÔ∏è Travel</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="expenseDescription"><i class="fas fa-file-alt"></i> Description (Optional)</label>
                        <input type="text" id="expenseDescription" placeholder="Describe this practice expense">
                    </div>
                    <button class="btn btn-danger btn-block" onclick="addPracticeExpense()">
                        <i class="fas fa-minus-circle"></i> Add Practice Expense
                    </button>
                </div>

                <!-- TRANSACTION HISTORY -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-history"></i> Practice Activity History</h2>
                    <div class="transaction-list" id="transactionList">
                        <!-- Transactions will be loaded here -->
                    </div>
                </div>

                <!-- LEARNING PROGRESS -->
                <div class="section">
                    <h2 class="section-title"><i class="fas fa-trophy"></i> Learning Progress</h2>
                    <div class="xp-bar-container">
                        <div class="xp-bar">
                            <div class="xp-fill" id="xpFill" style="width: 30%;"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 12px;">
                            <span>Level 1</span>
                            <span id="xpText">30/100 XP</span>
                        </div>
                    </div>
                    <div class="badges-container mt-10">
                        <div class="badge" title="First Lesson Completed">
                            üìö
                        </div>
                        <div class="badge" title="Budgeting Basics Mastered">
                            üí∞
                        </div>
                        <div class="badge locked" title="Complete 10 activities">
                            üèÜ
                        </div>
                        <div class="badge locked" title="Perfect Budget Score">
                            ‚≠ê
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LESSONS MODAL -->
    <div id="lessonsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-book"></i> Financial Literacy Lessons</h2>
                <button class="close-modal" onclick="closeModal('lessonsModal')">√ó</button>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                <div class="card lesson-card" onclick="startLesson('budgeting')">
                    <div style="font-size: 32px; margin-bottom: 10px;">üí∞</div>
                    <h3 style="color: var(--warning-color);">Budgeting Basics</h3>
                    <p style="color: var(--text-light); font-size: 14px;">Learn the 50/30/20 rule for income allocation</p>
                    <div style="display: flex; align-items: center; gap: 5px; margin-top: 10px;">
                        <i class="fas fa-clock"></i>
                        <span style="font-size: 12px;">15 min</span>
                    </div>
                </div>
                
                <div class="card lesson-card" onclick="startLesson('savings')">
                    <div style="font-size: 32px; margin-bottom: 10px;">üè¶</div>
                    <h3 style="color: var(--warning-color);">Savings Strategies</h3>
                    <p style="color: var(--text-light); font-size: 14px;">Different types of savings and their purposes</p>
                    <div style="display: flex; align-items: center; gap: 5px; margin-top: 10px;">
                        <i class="fas fa-clock"></i>
                        <span style="font-size: 12px;">20 min</span>
                    </div>
                </div>
                
                <div class="card lesson-card" onclick="startLesson('ghana-context')">
                    <div style="font-size: 32px; margin-bottom: 10px;">üá¨üá≠</div>
                    <h3 style="color: var(--warning-color);">Ghanaian Context</h3>
                    <p style="color: var(--text-light); font-size: 14px;">Financial considerations specific to Ghana</p>
                    <div style="display: flex; align-items: center; gap: 5px; margin-top: 10px;">
                        <i class="fas fa-clock"></i>
                        <span style="font-size: 12px;">25 min</span>
                    </div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="closeModal('lessonsModal')">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- CLASSROOM TOOLS MODAL -->
    <div id="classroomModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-chalkboard"></i> Classroom Tools</h2>
                <button class="close-modal" onclick="closeModal('classroomModal')">√ó</button>
            </div>
            
            <div class="form-group">
                <label>Create Classroom Session</label>
                <input type="text" id="className" placeholder="Enter class name (e.g., Math 101)">
            </div>
            
            <button class="btn btn-primary btn-block" onclick="createClassroom()">
                <i class="fas fa-plus"></i> Create Classroom
            </button>
            
            <div id="classroomInfo" style="display: none; margin-top: 20px;">
                <div class="classroom-code" id="classCode">CLASS-ABC123</div>
                <p style="text-align: center; color: var(--text-light); margin: 10px 0;">
                    Share this code with students
                </p>
                
                <div style="text-align: center;">
                    <button class="btn" style="background: #27ae60; color: white;" onclick="copyClassCode()">
                        <i class="fas fa-copy"></i> Copy Code
                    </button>
                    <button class="btn" style="background: #3498db; color: white;" onclick="generateQR()">
                        <i class="fas fa-qrcode"></i> Generate QR
                    </button>
                </div>
            </div>
            
            <div class="tip-box mt-20">
                <p><strong>üéì Teacher Instructions:</strong></p>
                <p>1. Create a classroom session</p>
                <p>2. Share the code with students</p>
                <p>3. Students join using the code</p>
                <p>4. Monitor progress in real-time</p>
            </div>
        </div>
    </div>

    <!-- LESSON CONTENT MODAL -->
    <div id="lessonModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="lessonTitle">Lesson Title</h2>
                <button class="close-modal" onclick="closeModal('lessonModal')">√ó</button>
            </div>
            
            <div id="lessonContent" style="margin-bottom: 20px;">
                <!-- Lesson content will be loaded here -->
            </div>
            
            <div id="lessonQuiz" style="display: none;">
                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Quick Quiz</h3>
                <div id="quizQuestion" style="margin-bottom: 15px;"></div>
                <div id="quizOptions" style="display: grid; gap: 10px;"></div>
                <div id="quizResult" style="display: none; margin-top: 15px;"></div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button id="prevLesson" class="btn" style="display: none;">
                    <i class="fas fa-arrow-left"></i> Previous
                </button>
                <button id="nextLesson" class="btn btn-primary" style="flex: 1;">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- QUIZ MODAL -->
    <div id="quizModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-question-circle"></i> Financial Literacy Quiz</h2>
                <button class="close-modal" onclick="closeModal('quizModal')">√ó</button>
            </div>
            
            <div id="quizContainer">
                <div id="currentQuestion">Question 1 of 5</div>
                <h3 id="questionText" style="margin: 15px 0;">What is the 50/30/20 rule?</h3>
                
                <div style="display: grid; gap: 10px; margin-bottom: 20px;">
                    <button class="btn quiz-option" onclick="selectAnswer(0)">
                        A. A marketing strategy
                    </button>
                    <button class="btn quiz-option" onclick="selectAnswer(1)">
                        B. A budgeting framework
                    </button>
                    <button class="btn quiz-option" onclick="selectAnswer(2)">
                        C. A savings interest rate
                    </button>
                    <button class="btn quiz-option" onclick="selectAnswer(3)">
                        D. A loan repayment plan
                    </button>
                </div>
                
                <div id="quizFeedback" style="display: none; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
                
                <div style="display: flex; justify-content: space-between;">
                    <button class="btn" onclick="prevQuestion()">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="btn btn-primary" onclick="nextQuestion()">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <div id="quizResults" style="display: none; text-align: center;">
                <div style="font-size: 48px; margin: 20px 0;">üéâ</div>
                <h3 style="color: var(--success-color);">Quiz Completed!</h3>
                <p>Your score: <span id="quizScore" style="font-size: 24px; font-weight: bold; color: var(--primary-color);">0</span>/5</p>
                <button class="btn btn-success" onclick="restartQuiz()">
                    <i class="fas fa-redo"></i> Try Again
                </button>
            </div>
        </div>
    </div>
     <div style="text-align: center; padding: 40px; background: #f8f9fa; border-radius: 10px; margin: 20px auto; max-width: 600px;">
        <h2 style="color: #2c3e50;">üìã Need to Copy This Project?</h2>
        <button onclick="copyAllCode()" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px 40px; border: none; border-radius: 10px; font-size: 20px; font-weight: bold; cursor: pointer; display: block; margin: 20px auto; box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);">
            üöÄ CLICK HERE TO COPY ALL CODE
        </button>
        <p style="color: #7f8c8d; margin-top: 15px;">Click above to copy everything, then paste into Notepad</p>
    </div>

    <!-- PROGRESS REPORT MODAL -->
    <div id="progressModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-chart-line"></i> Learning Progress Report</h2>
                <button class="close-modal" onclick="closeModal('progressModal')">√ó</button>
            </div>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 48px; margin-bottom: 10px;">üìä</div>
                <h3 id="studentName">Student Learner</h3>
                <p style="color: var(--text-light);">Financial Literacy Progress</p>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>Learning Level</span>
                    <span id="currentLevel" style="font-weight: bold;">Level 1</span>
                </div>
                <div class="xp-bar">
                    <div class="xp-fill" id="progressXP" style="width: 30%;"></div>
                </div>
                <div style="text-align: center; font-size: 12px; color: var(--text-light); margin-top: 5px;">
                    <span id="xpProgress">30/100 XP</span>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">Completed Lessons</h4>
                <div id="completedLessons">
                    <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;">
                        <span>Budgeting Basics</span>
                        <span style="color: var(--success-color);">‚úÖ</span>
                    </div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">Achievements</h4>
                <div class="badges-container">
                    <div class="badge" title="First Lesson Completed">üìö</div>
                    <div class="badge" title="Budgeting Basics Mastered">üí∞</div>
                </div>
            </div>
            
            <button class="btn btn-primary btn-block" onclick="generateCertificate()">
                <i class="fas fa-certificate"></i> Generate Certificate
            </button>
        </div>
    </div>

    <!-- PWA SERVICE WORKER & MANIFEST -->
    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log('ServiceWorker registered:', registration);
                }).catch(error => {
                    console.log('ServiceWorker registration failed:', error);
                });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            setTimeout(() => {
                document.getElementById('pwaPrompt').style.display = 'block';
            }, 3000);
        });

        document.getElementById('installPWA').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    console.log('PWA installed');
                }
                deferredPrompt = null;
                document.getElementById('pwaPrompt').style.display = 'none';
            }
        });

        document.getElementById('dismissPWA').addEventListener('click', () => {
            document.getElementById('pwaPrompt').style.display = 'none';
        });
    </script>

    <!-- MANIFEST.JSON (Inline for demo) -->
    <script type="application/json" id="manifest-json">
        {
            "name": "Financial Literacy Simulator",
            "short_name": "FinLit GH",
            "description": "Educational financial literacy simulator for Ghanaian students",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#2c3e50",
            "theme_color": "#2c3e50",
            "icons": [
                {
                    "src": "/icons/icon-72x72.png",
                    "sizes": "72x72",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-96x96.png",
                    "sizes": "96x96",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-128x128.png",
                    "sizes": "128x128",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-144x144.png",
                    "sizes": "144x144",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-152x152.png",
                    "sides": "152x152",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-192x192.png",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-384x384.png",
                    "sizes": "384x384",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-512x512.png",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        }
    </script>

    <!-- MAIN APPLICATION CODE -->
    <script>
        // ============================================
        // GLOBAL STATE
        // ============================================
        const SIMULATOR_MODE = true;
        let currentUser = null;
        let transactions = [];
        let currentLesson = null;
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let quizScore = 0;

        //FUNCTION FOR TEACHERS
        // ============================================
        function copyAllCode() {
            // Get the entire HTML content
            const htmlContent = document.documentElement.outerHTML;
            
            // Create a textarea element
            const textArea = document.createElement('textarea');
            textArea.value = htmlContent;
            document.body.appendChild(textArea);
            
            // Select and copy
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            // Show confirmation
            const button = document.querySelector('button[onclick="copyAllCode()"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚úÖ COPIED! Now open Notepad';
            button.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
            }, 3000);
            
            alert('‚ú® All code copied! Now:\n1. Open Notepad\n2. Press CTRL + V\n3. Save as: financial-simulator.html');
        }

        // Sample Ghanaian financial data
        const sampleData = {
            student: {
                name: "Kwame (Student)",
                avatar: "üë®‚Äçüéì",
                income: 2000,
                expenses: [
                    { amount: 600, category: "Housing", description: "Hostel fees" },
                    { amount: 400, category: "Food", description: "Monthly groceries" },
                    { amount: 200, category: "Transport", description: "Tro-tro fare" }
                ]
            },
            teacher: {
                name: "Ama (Teacher)",
                avatar: "üë©‚Äçüè´",
                income: 3500,
                expenses: [
                    { amount: 1000, category: "Housing", description: "Rent" },
                    { amount: 600, category: "Food", description: "Food & groceries" },
                    { amount: 400, category: "Transport", description: "Car fuel" },
                    { amount: 300, category: "Education", description: "Professional development" }
                ]
            },
            entrepreneur: {
                name: "Kofi (Entrepreneur)",
                avatar: "üë®‚Äçüíº",
                income: 5000,
                expenses: [
                    { amount: 1200, category: "Housing", description: "Mortgage" },
                    { amount: 800, category: "Food", description: "Family groceries" },
                    { amount: 600, category: "Transport", description: "Business travel" },
                    { amount: 1000, category: "Business", description: "Business expenses" }
                ]
            }
        };

        // Financial lessons data
        const lessons = {
            budgeting: {
                title: "üí∞ Budgeting Basics - The 50/30/20 Rule",
                content: `
                    <div style="margin-bottom: 20px;">
                        <p>The <strong>50/30/20 rule</strong> is a simple budgeting framework that helps you allocate your income effectively:</p>
                        
                        <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4 style="color: var(--primary-color); margin-bottom: 10px;">üá¨üá≠ Ghanaian Example:</h4>
                            <p>If you earn <strong>GH‚Çµ2,000</strong> per month:</p>
                            <ul style="margin-left: 20px;">
                                <li><strong>50% Needs (GH‚Çµ1,000):</strong> Rent, food, transport, utilities</li>
                                <li><strong>30% Wants (GH‚Çµ600):</strong> Entertainment, eating out, shopping</li>
                                <li><strong>20% Savings (GH‚Çµ400):</strong> Emergency fund, investments, future goals</li>
                            </ul>
                        </div>
                        
                        <div class="tip-box">
                            <p><strong>üí° Pro Tip for Ghana:</strong></p>
                            <p>Adjust percentages based on your location. In Accra, housing might take 40-50% of income, while in smaller towns it could be 25-35%.</p>
                        </div>
                    </div>
                `,
                quiz: {
                    question: "If you earn GH‚Çµ3,000 monthly, how much should go to savings using the 50/30/20 rule?",
                    options: ["GH‚Çµ600", "GH‚Çµ900", "GH‚Çµ1,200", "GH‚Çµ1,500"],
                    answer: 0,
                    explanation: "Correct! 20% of GH‚Çµ3,000 is GH‚Çµ600. This should go to savings and investments."
                }
            },
            savings: {
                title: "üè¶ Savings Strategies for Ghanaians",
                content: `
                    <div style="margin-bottom: 20px;">
                        <p>Savings are crucial for financial security. Here are common savings types in Ghana:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                            <div style="background: #e8f4fc; padding: 15px; border-radius: 8px;">
                                <h4 style="color: var(--secondary-color);">üö® Emergency Fund</h4>
                                <p style="font-size: 14px;">3-6 months of expenses. Keep in mobile money or savings account.</p>
                            </div>
                            <div style="background: #e8f8f5; padding: 15px; border-radius: 8px;">
                                <h4 style="color: var(--success-color);">üè† Housing Fund</h4>
                                <p style="font-size: 14px;">Save for rent deposit or mortgage down payment.</p>
                            </div>
                            <div style="background: #fff8e1; padding: 15px; border-radius: 8px;">
                                <h4 style="color: var(--warning-color);">üéì Education Fund</h4>
                                <p style="font-size: 14px;">For children's education or professional development.</p>
                            </div>
                        </div>
                        
                        <div class="tip-box">
                            <p><strong>üá¨üá≠ Ghanaian Savings Options:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>Mobile Money:</strong> MTN MoMo, AirtelTigo Money, Vodafone Cash</li>
                                <li><strong>Bank Savings:</strong> Traditional banks with interest</li>
                                <li><strong>Susu Collectors:</strong> Traditional savings collectors</li>
                                <li><strong>Investment Apps:</strong> Digital platforms for investing</li>
                            </ul>
                        </div>
                    </div>
                `,
                quiz: {
                    question: "What is the recommended emergency fund size?",
                    options: ["1-2 months expenses", "3-6 months expenses", "1 year expenses", "No emergency fund needed"],
                    answer: 1,
                    explanation: "Correct! 3-6 months of expenses is recommended for emergencies like job loss or medical issues."
                }
            },
            'ghana-context': {
                title: "üá¨üá≠ Financial Considerations in Ghana",
                content: `
                    <div style="margin-bottom: 20px;">
                        <p>Understanding the Ghanaian financial context is key to good money management:</p>
                        
                        <div style="margin: 20px 0; padding: 15px; background: #f0f7ff; border-radius: 8px;">
                            <h4 style="color: var(--primary-color);">üíµ Average Monthly Expenses (Accra)</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                                <div>
                                    <p style="margin: 5px 0;"><strong>Single person:</strong></p>
                                    <ul style="font-size: 14px;">
                                        <li>Rent: GH‚Çµ600-1,200</li>
                                        <li>Food: GH‚Çµ400-600</li>
                                        <li>Transport: GH‚Çµ200-400</li>
                                        <li>Utilities: GH‚Çµ150-300</li>
                                    </ul>
                                </div>
                                <div>
                                    <p style="margin: 5px 0;"><strong>Family of 4:</strong></p>
                                    <ul style="font-size: 14px;">
                                        <li>Rent: GH‚Çµ1,500-3,000</li>
                                        <li>Food: GH‚Çµ1,000-1,500</li>
                                        <li>School fees: GH‚Çµ200-800</li>
                                        <li>Healthcare: GH‚Çµ100-300</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tip-box">
                            <p><strong>üí° Cultural Financial Practices:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>Extended Family Support:</strong> Budget for family responsibilities</li>
                                <li><strong>Funeral Contributions:</strong> Common financial obligation</li>
                                <li><strong>Festival Seasons:</strong> Increased spending during holidays</li>
                                <li><strong>Community Contributions:</strong> Church, mosque, or community dues</li>
                            </ul>
                        </div>
                    </div>
                `,
                quiz: {
                    question: "Which is NOT typically included in Ghanaian family budgeting?",
                    options: ["School fees", "Funeral contributions", "Extended family support", "International travel fund"],
                    answer: 3,
                    explanation: "Correct! While international travel might happen, it's not a regular budget item for most families."
                }
            }
        };

        // Quiz questions
        quizQuestions = [
            {
                question: "What is the 50/30/20 rule?",
                options: [
                    "A marketing strategy",
                    "A budgeting framework for income allocation",
                    "A savings interest rate",
                    "A loan repayment plan"
                ],
                answer: 1,
                explanation: "Correct! The 50/30/20 rule helps allocate income to needs (50%), wants (30%), and savings (20%)."
            },
            {
                question: "What percentage should go to savings in the 50/30/20 rule?",
                options: ["10%", "20%", "30%", "50%"],
                answer: 1,
                explanation: "Correct! 20% of income should go to savings and investments."
            },
            {
                question: "Which is an example of a 'need' in budgeting?",
                options: ["Rent payment", "Movie tickets", "New smartphone", "Vacation trip"],
                answer: 0,
                explanation: "Correct! Rent is a basic need, while the others are wants."
            },
            {
                question: "What is an emergency fund for?",
                options: [
                    "Buying luxury items",
                    "Unexpected expenses like medical bills",
                    "Regular monthly expenses",
                    "Entertainment"
                ],
                answer: 1,
                explanation: "Correct! Emergency funds are for unexpected expenses like medical emergencies or job loss."
            },
            {
                question: "In Ghana, what financial app is commonly used for savings?",
                options: ["MTN MoMo", "Instagram", "WhatsApp", "TikTok"],
                answer: 0,
                explanation: "Correct! MTN Mobile Money (MoMo) is widely used for savings and transactions in Ghana."
            }
        ];

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Show warning banner
            createSimulatorBanner();
            
            // Setup event listeners
            setupEventListeners();
            
            // Check if disclaimer was accepted
            checkDisclaimer();
        });

        function createSimulatorBanner() {
            // Banner is already in HTML, just make sure it's visible
            document.getElementById('simulator-warning').style.display = 'block';
        }

        function checkDisclaimer() {
            if (localStorage.getItem('finlit_disclaimer_accepted')) {
                // Disclaimer accepted, show welcome modal
                document.getElementById('legalDisclaimerModal').style.display = 'none';
                document.getElementById('welcomeModal').style.display = 'flex';
            } else {
                // Show disclaimer
                document.getElementById('legalDisclaimerModal').style.display = 'flex';
            }
        }

        function setupEventListeners() {
            // Accept disclaimer
            document.getElementById('acceptDisclaimer').addEventListener('click', acceptDisclaimer);
            
            // Close modals when clicking outside
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                    }
                });
            });
        }

        function acceptDisclaimer() {
            localStorage.setItem('finlit_disclaimer_accepted', 'true');
            document.getElementById('legalDisclaimerModal').style.display = 'none';
            document.getElementById('welcomeModal').style.display = 'flex';
        }

        // ============================================
        // USER MANAGEMENT
        // ============================================
        function startLearning(role) {
            document.getElementById('welcomeModal').style.display = 'none';
            
            // Set user based on role
            currentUser = {
                role: role,
                ...sampleData[role],
                xp: 50,
                level: 1,
                completedLessons: ['budgeting'],
                achievements: ['first_lesson']
            };
            
            // Update UI
            updateUserDisplay();
            loadSampleTransactions();
            updateSummary();
            
            // Show main app
            document.getElementById('appContainer').style.display = 'block';
            
            // Show welcome message
            showNotification(`Welcome ${currentUser.name}! Ready to learn financial literacy?`);
        }

        function updateUserDisplay() {
            document.getElementById('userAvatar').textContent = currentUser.avatar;
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = `Level ${currentUser.level} ‚Ä¢ ${currentUser.xp} XP`;
            
            // Update XP bar
            const xpPercent = (currentUser.xp % 100);
            document.getElementById('xpFill').style.width = `${xpPercent}%`;
            document.getElementById('xpText').textContent = `${xpPercent}/100 XP`;
        }

        // ============================================
        // TRANSACTION MANAGEMENT
        // ============================================
        function loadSampleTransactions() {
            transactions = [];
            
            // Add sample income
            transactions.push({
                id: 'sample_income',
                type: 'income',
                amount: currentUser.income,
                category: 'Salary',
                description: 'Monthly simulated income',
                date: new Date().toLocaleDateString(),
                time: '09:00 AM',
                color: 'success'
            });
            
            // Add sample expenses
            currentUser.expenses.forEach(expense => {
                transactions.push({
                    id: 'expense_' + Date.now() + Math.random(),
                    type: 'expense',
                    amount: expense.amount,
                    category: expense.category,
                    description: expense.description,
                    date: new Date().toLocaleDateString(),
                    time: '10:00 AM',
                    color: 'danger'
                });
            });
            
            updateTransactionList();
        }

        function addSimulatedIncome() {
            const amount = document.getElementById('incomeAmount').value;
            const source = document.getElementById('incomeSource').value;
            const description = document.getElementById('incomeDescription').value;
            
            if (!amount || amount <= 0) {
                showNotification('Please enter a valid amount', 'warning');
                return;
            }
            
            const transaction = {
                id: 'income_' + Date.now(),
                type: 'income',
                amount: parseFloat(amount),
                category: source,
                description: description || 'Simulated income',
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                color: 'success'
            };
            
            transactions.unshift(transaction);
            updateTransactionList();
            updateSummary();
            addXP(10);
            
            // Clear form
            document.getElementById('incomeAmount').value = '';
            document.getElementById('incomeDescription').value = '';
            
            showNotification('Simulated income added! +10 XP', 'success');
        }

        function addPracticeExpense() {
            const amount = document.getElementById('expenseAmount').value;
            const category = document.getElementById('expenseCategory').value;
            const description = document.getElementById('expenseDescription').value;
            
            if (!amount || amount <= 0) {
                showNotification('Please enter a valid amount', 'warning');
                return;
            }
            
            if (!category) {
                showNotification('Please select a category', 'warning');
                return;
            }
            
            const transaction = {
                id: 'expense_' + Date.now(),
                type: 'expense',
                amount: parseFloat(amount),
                category: category,
                description: description || 'Practice expense',
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                color: 'danger'
            };
            
            transactions.unshift(transaction);
            updateTransactionList();
            updateSummary();
            addXP(5);
            
            // Clear form
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseCategory').value = '';
            document.getElementById('expenseDescription').value = '';
            
            showNotification('Practice expense added! +5 XP', 'success');
        }

        function updateTransactionList() {
            const container = document.getElementById('transactionList');
            container.innerHTML = '';
            
            transactions.slice(0, 10).forEach(transaction => {
                const div = document.createElement('div');
                div.className = 'transaction-item';
                
                const isIncome = transaction.type === 'income';
                const emoji = isIncome ? 'üí∞' : 'üí∏';
                const color = isIncome ? '#27ae60' : '#e74c3c';
                
                div.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="background: ${color}; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">
                            ${emoji}
                        </div>
                        <div>
                            <div style="font-weight: bold; color: ${color};">GH‚Çµ ${transaction.amount.toFixed(2)}</div>
                            <div style="font-size: 14px; color: var(--text-color);">${transaction.category}</div>
                            <div style="font-size: 12px; color: var(--text-light);">${transaction.time} ‚Ä¢ ${transaction.description}</div>
                        </div>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        function updateSummary() {
            let totalIncome = 0;
            let totalExpenses = 0;
            
            transactions.forEach(t => {
                if (t.type === 'income') {
                    totalIncome += t.amount;
                } else {
                    totalExpenses += t.amount;
                }
            });
            
            const balance = totalIncome - totalExpenses;
            
            // Update funds (simplified allocation)
            const allocation = {
                ownership: totalIncome * 0.10,
                emergency: totalIncome * 0.10,
                growth: totalIncome * 0.05,
                operations: balance
            };
            
            document.getElementById('totalIncome').textContent = `GH‚Çµ ${totalIncome.toFixed(2)}`;
            document.getElementById('totalExpenses').textContent = `GH‚Çµ ${totalExpenses.toFixed(2)}`;
            document.getElementById('balance').textContent = `GH‚Çµ ${balance.toFixed(2)}`;
            
            document.getElementById('ownershipFund').textContent = `GH‚Çµ ${allocation.ownership.toFixed(2)}`;
            document.getElementById('emergencyFund').textContent = `GH‚Çµ ${allocation.emergency.toFixed(2)}`;
            document.getElementById('growthFund').textContent = `GH‚Çµ ${allocation.growth.toFixed(2)}`;
            document.getElementById('operationsFund').textContent = `GH‚Çµ ${allocation.operations.toFixed(2)}`;
        }

        // ============================================
        // LESSON SYSTEM
        // ============================================
        function showLesson(lessonId) {
            openModal('lessonsModal');
        }

        function startLesson(lessonId) {
            currentLesson = lessons[lessonId];
            
            document.getElementById('lessonTitle').textContent = currentLesson.title;
            document.getElementById('lessonContent').innerHTML = currentLesson.content;
            
            // Setup quiz section
            if (currentLesson.quiz) {
                document.getElementById('lessonQuiz').style.display = 'block';
                document.getElementById('quizQuestion').textContent = currentLesson.quiz.question;
                
                const optionsContainer = document.getElementById('quizOptions');
                optionsContainer.innerHTML = '';
                
                currentLesson.quiz.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'btn';
                    button.style.cssText = 'text-align: left; justify-content: flex-start;';
                    button.innerHTML = `${String.fromCharCode(65 + index)}. ${option}`;
                    button.onclick = () => checkQuizAnswer(index);
                    optionsContainer.appendChild(button);
                });
                
                document.getElementById('quizResult').style.display = 'none';
            } else {
                document.getElementById('lessonQuiz').style.display = 'none';
            }
            
            closeModal('lessonsModal');
            openModal('lessonModal');
        }

        function checkQuizAnswer(selectedIndex) {
            const resultDiv = document.getElementById('quizResult');
            
            if (selectedIndex === currentLesson.quiz.answer) {
                resultDiv.innerHTML = `
                    <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 8px;">
                        ‚úÖ <strong>Correct!</strong><br>
                        ${currentLesson.quiz.explanation}
                    </div>
                `;
                addXP(20);
                showNotification('Quiz passed! +20 XP', 'success');
            } else {
                resultDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px;">
                        ‚ùå <strong>Incorrect.</strong><br>
                        The correct answer is: ${currentLesson.quiz.options[currentLesson.quiz.answer]}<br>
                        ${currentLesson.quiz.explanation}
                    </div>
                `;
                addXP(5);
            }
            
            resultDiv.style.display = 'block';
            
            // Add lesson to completed if not already
            if (!currentUser.completedLessons.includes(currentLesson)) {
                currentUser.completedLessons.push(currentLesson);
            }
        }

        // ============================================
        // CLASSROOM FEATURES
        // ============================================
        function showClassroomTools() {
            openModal('classroomModal');
        }

        function createClassroom() {
            const className = document.getElementById('className').value;
            if (!className) {
                showNotification('Please enter a class name', 'warning');
                return;
            }
            
            // Generate class code
            const code = 'CLASS-' + Math.random().toString(36).substr(2, 6).toUpperCase();
            
            document.getElementById('classCode').textContent = code;
            document.getElementById('classroomInfo').style.display = 'block';
            
            showNotification(`Classroom "${className}" created! Code: ${code}`, 'success');
        }

        function copyClassCode() {
            const code = document.getElementById('classCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('Class code copied to clipboard!', 'success');
            });
        }

        function generateQR() {
            const code = document.getElementById('classCode').textContent;
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(window.location.origin + '/join/' + code)}`;
            
            alert(`QR Code URL: ${qrUrl}\n\nShare this with students to join your classroom.`);
        }

        // ============================================
        // QUIZ SYSTEM
        // ============================================
        function showQuiz() {
            currentQuestionIndex = 0;
            quizScore = 0;
            loadQuizQuestion();
            openModal('quizModal');
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('quizResults').style.display = 'none';
        }

        function loadQuizQuestion() {
            const question = quizQuestions[currentQuestionIndex];
            
            document.getElementById('currentQuestion').textContent = `Question ${currentQuestionIndex + 1} of ${quizQuestions.length}`;
            document.getElementById('questionText').textContent = question.question;
            
            const options = document.querySelectorAll('.quiz-option');
            options.forEach((btn, index) => {
                btn.textContent = `${String.fromCharCode(65 + index)}. ${question.options[index]}`;
                btn.style.background = '#f8f9fa';
                btn.style.color = 'var(--text-color)';
                btn.onclick = () => selectAnswer(index);
            });
            
            document.getElementById('quizFeedback').style.display = 'none';
        }

        function selectAnswer(index) {
            const question = quizQuestions[currentQuestionIndex];
            const options = document.querySelectorAll('.quiz-option');
            
            // Reset all buttons
            options.forEach(btn => {
                btn.style.background = '#f8f9fa';
                btn.style.color = 'var(--text-color)';
            });
            
            // Highlight selected
            options[index].style.background = '#3498db';
            options[index].style.color = 'white';
            
            // Check answer
            const feedback = document.getElementById('quizFeedback');
            if (index === question.answer) {
                feedback.innerHTML = '<div style="color: #27ae60;">‚úÖ Correct! ' + question.explanation + '</div>';
                quizScore++;
            } else {
                feedback.innerHTML = `<div style="color: #e74c3c;">‚ùå Incorrect. The correct answer is: ${question.options[question.answer]}</div>`;
            }
            
            feedback.style.display = 'block';
        }

        function nextQuestion() {
            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuizQuestion();
            } else {
                // Show results
                document.getElementById('quizContainer').style.display = 'none';
                document.getElementById('quizResults').style.display = 'block';
                document.getElementById('quizScore').textContent = quizScore;
                
                // Add XP based on score
                addXP(quizScore * 10);
                
                if (quizScore === quizQuestions.length) {
                    showNotification('Perfect quiz score! +50 XP', 'success');
                    addXP(20); // Bonus
                }
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuizQuestion();
            }
        }

        function restartQuiz() {
            showQuiz();
        }

        // ============================================
        // PROGRESS & ACHIEVEMENTS
        // ============================================
        function showProgress() {
            if (!currentUser) {
                showNotification('Please start learning first', 'warning');
                return;
            }
            
            document.getElementById('studentName').textContent = currentUser.name;
            document.getElementById('currentLevel').textContent = `Level ${currentUser.level}`;
            document.getElementById('progressXP').style.width = `${currentUser.xp % 100}%`;
            document.getElementById('xpProgress').textContent = `${currentUser.xp % 100}/100 XP`;
            
            // Update completed lessons
            const completedDiv = document.getElementById('completedLessons');
            completedDiv.innerHTML = '';
            
            Object.keys(lessons).forEach(lessonId => {
                if (currentUser.completedLessons.includes(lessonId)) {
                    const div = document.createElement('div');
                    div.style.cssText = 'display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee;';
                    div.innerHTML = `<span>${lessons[lessonId].title}</span><span style="color: var(--success-color);">‚úÖ</span>`;
                    completedDiv.appendChild(div);
                }
            });
            
            openModal('progressModal');
        }

        function addXP(points) {
            if (!currentUser) return;
            
            currentUser.xp += points;
            
            // Level up every 100 XP
            const newLevel = Math.floor(currentUser.xp / 100) + 1;
            if (newLevel > currentUser.level) {
                currentUser.level = newLevel;
                showNotification(`üéâ Level Up! You're now Level ${newLevel}`, 'success');
            }
            
            updateUserDisplay();
        }

        function generateCertificate() {
            if (!currentUser) return;
            
            // Create a simple certificate in a new window
            const certificateWindow = window.open('', '_blank');
            certificateWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Certificate of Financial Literacy</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            text-align: center; 
                            padding: 40px;
                            background: #f8f9fa;
                        }
                        .certificate {
                            background: white;
                            border: 10px solid gold;
                            padding: 50px;
                            max-width: 800px;
                            margin: 0 auto;
                            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                        }
                        h1 { color: #2c3e50; }
                        .name { font-size: 36px; color: #3498db; margin: 20px 0; }
                        .details { font-size: 18px; color: #7f8c8d; margin: 20px 0; }
                        .footer { margin-top: 40px; color: #95a5a6; }
                    </style>
                </head>
                <body>
                    <div class="certificate">
                        <h1>üèÜ Certificate of Financial Literacy</h1>
                        <p>This certifies that</p>
                        <div class="name">${currentUser.name}</div>
                        <p>has successfully completed the Financial Literacy Simulator program</p>
                        <div class="details">
                            <p>Level: ${currentUser.level}</p>
                            <p>XP Earned: ${currentUser.xp}</p>
                            <p>Lessons Completed: ${currentUser.completedLessons.length}</p>
                            <p>Date: ${new Date().toLocaleDateString()}</p>
                        </div>
                        <p>This certificate recognizes the achievement in learning essential financial management skills.</p>
                        <div class="footer">
                            <p>Financial Literacy Simulator ‚Ä¢ Ghana Education Edition</p>
                            <p>This is a simulated certificate for educational purposes</p>
                        </div>
                    </div>
                </body>
                </html>
            `);
            certificateWindow.document.close();
            
            showNotification('Certificate generated!', 'success');
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? '#27ae60' : type === 'warning' ? '#f39c12' : '#3498db'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10002;
                animation: slideIn 0.3s ease;
            `;
            notification.innerHTML = message;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
            
            // Add keyframes if not exists
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        function resetSimulator() {
            if (confirm('Reset the simulator? This will clear all practice data.')) {
                localStorage.removeItem('finlit_disclaimer_accepted');
                location.reload();
            }
        }

        // ============================================
        // PWA SERVICE WORKER
        // ============================================
        // Create service worker file content (for demo, we'll create it dynamically)
        if ('serviceWorker' in navigator) {
            const swContent = `
                const CACHE_NAME = 'finlit-simulator-v1';
                const urlsToCache = [
                    '/',
                    '/index.html',
                    '/manifest.json'
                ];

                self.addEventListener('install', event => {
                    event.waitUntil(
                        caches.open(CACHE_NAME)
                            .then(cache => cache.addAll(urlsToCache))
                    );
                });

                self.addEventListener('fetch', event => {
                    event.respondWith(
                        caches.match(event.request)
                            .then(response => response || fetch(event.request))
                    );
                });

                self.addEventListener('activate', event => {
                    event.waitUntil(
                        caches.keys().then(cacheNames => {
                            return Promise.all(
                                cacheNames.map(cacheName => {
                                    if (cacheName !== CACHE_NAME) {
                                        return caches.delete(cacheName);
                                    }
                                })
                            );
                        })
                    );
                });
            `;

            // Create a blob URL for the service worker
            const blob = new Blob([swContent], { type: 'application/javascript' });
            const swUrl = URL.createObjectURL(blob);

            // Register the service worker
            navigator.serviceWorker.register(swUrl).then(registration => {
                console.log('Service Worker registered with scope:', registration.scope);
            }).catch(error => {
                console.log('Service Worker registration failed:', error);
            });
        }

        // ============================================
        // OFFLINE SUPPORT
        // ============================================
        window.addEventListener('online', function() {
            showNotification('You are back online', 'success');
        });

        window.addEventListener('offline', function() {
            showNotification('You are offline. Some features may be limited.', 'warning');
        });

        // Check initial online status
        if (!navigator.onLine) {
            showNotification('You are offline. Some features may be limited.', 'warning');
        }
    </script>

    <!-- OFFLINE FALLBACK -->
    <noscript>
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: white; z-index: 10000; padding: 40px; text-align: center;">
            <h1>‚ö†Ô∏è JavaScript Required</h1>
            <p>This financial literacy simulator requires JavaScript to function.</p>
            <p>Please enable JavaScript in your browser settings.</p>
        </div>
    </noscript>

    <!-- FALLBACK FOR OLD BROWSERS -->
    <script>
        // Check for modern browser features
        if (!window.Promise || !window.fetch || !window.localStorage) {
            document.body.innerHTML = `
                <div style="max-width: 600px; margin: 100px auto; padding: 40px; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); text-align: center;">
                    <h1 style="color: #e74c3c;">‚ö†Ô∏è Browser Update Required</h1>
                    <p>Your browser doesn't support all features needed for this simulator.</p>
                    <p>Please update to a modern browser like:</p>
                    <div style="display: flex; justify-content: center; gap: 20px; margin: 30px 0;">
                        <div>üåê Chrome</div>
                        <div>üî• Firefox</div>
                        <div>üó∫Ô∏è Edge</div>
                    </div>
                    <p>This ensures the best learning experience.</p>
                </div>
            `;
        }
    </script>

</body></html>